import pandas as pd
from google.colab import files

# Upload the files
print("Please upload the 'Coca-Cola_stock_history.csv' and 'Coca-Cola_stock_info.csv' files.")
uploaded = files.upload()

# Check if files were uploaded
if 'Coca-Cola_stock_history.csv' in uploaded and 'Coca-Cola_stock_info.csv' in uploaded:
    df_history = pd.read_csv('Coca-Cola_stock_history.csv')
    df_info = pd.read_csv('Coca-Cola_stock_info.csv')

    display(df_history.head())
    display(df_history.info())
    display(df_info.head())
    display(df_info.info())
else:
    print("Please make sure both files are uploaded.")



from matplotlib import pyplot as plt
import seaborn as sns
df_info.groupby('Key').size().plot(kind='barh', color=sns.palettes.mpl_palette('Dark2'))
plt.gca().spines[['top', 'right',]].set_visible(False)

df_history['Date'] = pd.to_datetime(df_history['Date'], format='mixed')
df_history = df_history.set_index('Date')

print("Missing values in df_history:")
display(df_history.isnull().sum())

print("\nMissing values in df_info:")
display(df_info.isnull().sum())

summary = """
**Summary of Coca-Cola Stock Data Analysis**

This project aimed to analyze Coca-Cola stock data using historical stock prices (`Coca-Cola_stock_history.csv`) and company information (`Coca-Cola_stock_info.csv`), following the instructions outlined in a PDF document (`Coca Cola Stock - Live and Updated ( ML _ FA _ DA projects).pdf`).

**Process Followed:**

1.  **Data Loading:** The historical stock data and company information were successfully loaded into pandas DataFrames (`df_history` and `df_info`).
2.  **Data Cleaning and Preprocessing:**
    *   The 'Date' column in `df_history` was converted to datetime objects and set as the index.
    *   Missing values were checked in both DataFrames. `df_history` had no missing values, while `df_info` had missing values in the 'Value' column.
    *   Further preprocessing steps, such as handling missing values in `df_info`, outlier detection, and data transformation, could not be fully implemented due to the lack of specific instructions in the inaccessible PDF.
3.  **Exploratory Data Analysis (EDA):**
    *   Descriptive statistics were generated for the numerical columns in `df_history`, providing an overview of the data distribution.
    *   Trends in the historical 'Close' price and 'Volume' were visualized through line plots, showing the stock's performance and trading activity over time.
    *   The `df_info` DataFrame was examined to understand the type of company-specific information available.

**Limitations:**

A significant limitation throughout this project was the **unavailability of the PDF document** (`Coca Cola Stock - Live and Updated ( ML _ FA _ DA projects).pdf`). This document was intended to provide the specific requirements, methodologies, analysis techniques, modeling approaches, evaluation metrics, and output formats for the project. Without access to this crucial information, it was not possible to:

*   Perform complete and targeted data cleaning and preprocessing based on project needs.
*   Implement the specific analysis or machine learning models required.
*   Evaluate model performance and interpret results according to the project's goals.
*   Generate the exact required outputs as specified in the PDF.

**Key Insights from EDA:**

*   The historical stock data (`df_history`) provides a comprehensive record of daily trading, including open, high, low, and closing prices, as well as trading volume, dividends, and stock splits over a long period.
*   The 'Close' price trend shows the overall historical movement of the stock, indicating periods of growth and decline.
*   The 'Volume' trend highlights periods of increased or decreased trading activity, which can correlate with significant market events or investor interest.
*   The `df_info` DataFrame contains a variety of information about Coca-Cola, including fundamental data (like sector, employees, business summary), financial metrics, and contact details. The 'Value' column holds diverse data types, requiring careful handling for any quantitative analysis.

**Conclusion:**

While a comprehensive analysis, model implementation, and generation of specific outputs based on the PDF document were not possible due to its inaccessibility, the initial steps of data loading, basic cleaning and preprocessing, and exploratory data analysis were successfully completed. The available data has been explored to understand its structure, content, and general trends, laying a foundation for further analysis if the detailed project requirements become available.
"""

print(summary)


print("Acknowledgement: The specific output requirements for this project are detailed in the PDF document 'Coca Cola Stock - Live and Updated ( ML _ FA _ DA projects).pdf'.")
print("Limitation: Due to the inability to access the content of this PDF, it is impossible to generate the exact required outputs as specified in the document.")
print("Placeholder Output: As a demonstration of capability and to provide potentially relevant outputs, the following are generated: a CSV file containing historical closing prices and a basic plot of the closing price trend, as these are likely components of a stock analysis report.")

# Save historical closing prices to a CSV file
df_history['Close'].to_csv('coca_cola_closing_prices.csv')
print("\nHistorical closing prices saved to 'coca_cola_closing_prices.csv'")

# Generate and display a line plot of the 'Close' price
import matplotlib.pyplot as plt

plt.figure(figsize=(12, 6))
plt.plot(df_history.index, df_history['Close'],color='red')
plt.title('Coca-Cola Stock Closing Price Trend Over Time')
plt.xlabel('Date')
plt.ylabel('Closing Price')
plt.grid(True)
plt.show()

# Placeholder for analysis and modeling code
# Please refer to the PDF document "Coca Cola Stock - Live and Updated ( ML _ FA _ DA projects).pdf"
# for specific instructions on the analysis or modeling to be performed.

# Example: If the PDF required calculating moving averages, you might add:
df_history['Moving_Average_50'] = df_history['Close'].rolling(window=50).mean()
display(df_history.head())

# Example: If the PDF required a specific machine learning model, you might add:
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression

# Assuming 'Close' is the target variable and 'Volume' is a feature
X = df_history[['Volume']]
y = df_history['Close']

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

model = LinearRegression()
model.fit(X_train, y_train)

predictions = model.predict(X_test)
print("Sample predictions:", predictions[:5])

from matplotlib import pyplot as plt
import seaborn as sns
df_history['Open'].plot(kind='hist', bins=20, title='Open',color='red',edgecolor='black')
plt.gca().spines[['top', 'right',]].set_visible(False)





# Check if 'Date' is already the index
if 'Date' in df_history.columns:
    df_history['Date'] = pd.to_datetime(df_history['Date'], format='mixed')
    df_history = df_history.set_index('Date')
elif df_history.index.name != 'Date':
     # If 'Date' is not a column but the index is not named 'Date',
     # it might indicate an issue, but for this error, we assume it's already set.
     pass # Or add more robust error handling if needed

print("Missing values in df_history:")
display(df_history.isnull().sum())

print("\nMissing values in df_info:")
display(df_info.isnull().sum())






display(df_history.describe())

import matplotlib.pyplot as plt
import seaborn as sns

plt.figure(figsize=(12, 6))
sns.lineplot(data=df_history, x=df_history.index, y='Close',color='red')
plt.title('Coca-Cola Stock Close Price Over Time')
plt.xlabel('Date')
plt.ylabel('Close Price')
plt.grid(True)
plt.show()

plt.figure(figsize=(12, 6))
sns.lineplot(data=df_history, x=df_history.index, y='Volume',color='g')
plt.title('Coca-Cola Stock Trading Volume Over Time')
plt.xlabel('Date')
plt.ylabel('Volume')
plt.grid(True)
plt.show()



print("Relevant information from df_info:")
display(df_info)

# Since the 'Value' column is of object type and contains various types of information,
# it's not directly possible to analyze the distribution of all values numerically.
# We can filter for specific key financial metrics if needed based on the PDF,
# but without the PDF content, we will just display the info.


print("Acknowledgement: The specific output requirements for this project are detailed in the PDF document 'Coca Cola Stock - Live and Updated ( ML _ FA _ DA projects).pdf'.")
print("Limitation: Due to the inability to access the content of this PDF, it is impossible to generate the exact required outputs as specified in the document.")
print("Placeholder Output: As a demonstration of capability and to provide potentially relevant outputs, the following are generated: a CSV file containing historical closing prices and a basic plot of the closing price trend, as these are likely components of a stock analysis report.")

# Save historical closing prices to a CSV file
df_history['Close'].to_csv('coca_cola_closing_prices.csv')
print("\nHistorical closing prices saved to 'coca_cola_closing_prices.csv'")

# Generate and display a line plot of the 'Close' price
plt.figure(figsize=(12, 6))
plt.plot(df_history.index, df_history['Close'],color='purple')
plt.title('Coca-Cola Stock Closing Price Trend Over Time')
plt.xlabel('Date')
plt.ylabel('Closing Price')
plt.grid(True)
plt.show()


summary = """
**Summary of Coca-Cola Stock Data Analysis**

This project aimed to analyze Coca-Cola stock data using historical stock prices (`Coca-Cola_stock_history.csv`) and company information (`Coca-Cola_stock_info.csv`), following the instructions outlined in a PDF document (`Coca Cola Stock - Live and Updated ( ML _ FA _ DA projects).pdf`).

**Process Followed:**

1.  **Data Loading:** The historical stock data and company information were successfully loaded into pandas DataFrames (`df_history` and `df_info`).
2.  **Data Cleaning and Preprocessing:**
    *   The 'Date' column in `df_history` was converted to datetime objects and set as the index.
    *   Missing values were checked in both DataFrames. `df_history` had no missing values, while `df_info` had missing values in the 'Value' column.
    *   Further preprocessing steps, such as handling missing values in `df_info`, outlier detection, and data transformation, could not be fully implemented due to the lack of specific instructions in the inaccessible PDF.
3.  **Exploratory Data Analysis (EDA):**
    *   Descriptive statistics were generated for the numerical columns in `df_history`, providing an overview of the data distribution.
    *   Trends in the historical 'Close' price and 'Volume' were visualized through line plots, showing the stock's performance and trading activity over time.
    *   The `df_info` DataFrame was examined to understand the type of company-specific information available.

**Limitations:**

A significant limitation throughout this project was the **unavailability of the PDF document** (`Coca Cola Stock - Live and Updated ( ML _ FA _ DA projects).pdf`). This document was intended to provide the specific requirements, methodologies, analysis techniques, modeling approaches, evaluation metrics, and output formats for the project. Without access to this crucial information, it was not possible to:

*   Perform complete and targeted data cleaning and preprocessing based on project needs.
*   Implement the specific analysis or machine learning models required.
*   Evaluate model performance and interpret results according to the project's goals.
*   Generate the exact required outputs as specified in the PDF.

**Key Insights from EDA:**

*   The historical stock data (`df_history`) provides a comprehensive record of daily trading, including open, high, low, and closing prices, as well as trading volume, dividends, and stock splits over a long period.
*   The 'Close' price trend shows the overall historical movement of the stock, indicating periods of growth and decline.
*   The 'Volume' trend highlights periods of increased or decreased trading activity, which can correlate with significant market events or investor interest.
*   The `df_info` DataFrame contains a variety of information about Coca-Cola, including fundamental data (like sector, employees, business summary), financial metrics, and contact details. The 'Value' column holds diverse data types, requiring careful handling for any quantitative analysis.

**Conclusion:**

While a comprehensive analysis, model implementation, and generation of specific outputs based on the PDF document were not possible due to its inaccessibility, the initial steps of data loading, basic cleaning and preprocessing, and exploratory data analysis were successfully completed. The available data has been explored to understand its structure, content, and general trends, laying a foundation for further analysis if the detailed project requirements become available.
"""

print(summary)








